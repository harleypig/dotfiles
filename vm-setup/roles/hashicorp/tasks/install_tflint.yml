---
- name: Dump version information using the github_asset_name variable
  debug:
    msg: "Current version of tflint: {{ hashicorp_asset_current_version }}"
  when: version_tracking is defined

- name: Dump version information using the github_asset_name variable
  debug:
    msg: "Tempfile: {{ hashicorp_tempfile }}"
  when: version_tracking is defined

- name: Unzip the testfile
  become: yes
  unarchive:
    src: "{{ hashicorp_tempfile.path }}"
    dest: /usr/local/bin/
    include: tflint
    remote_src: yes
    mode: '0755'
  register: unarchive_result

- name: Update tflint version in version tracking
  lineinfile:
    path: "{{ version_tracking_file }}"
    regexp: '^tflint:.*$'
    line: "tflint: \"{{ github_release_latest_version }}\""
    create: yes
    backup: yes
  when: unarchive_result is succeeded

- name: Dump version information using the github_asset_name variable
  debug:
    msg: |
      Mismatch: {{ github_release_version_mismatch }}
      Download result: {{ github_release_download_result }}
  when: version_tracking is defined
