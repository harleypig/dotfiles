# shellcheck shell=bash

[[ -x "$(command -v terraform)" ]] || return 0

mkdir -p "$XDG_CACHE_HOME/terraform"
export TF_CLI_CONFIG_FILE="$XDG_CONFIG_HOME/terraform/terraformrc"

_terraform() {
  local cur="${COMP_WORDS[COMP_CWORD]}"
  local subcommands="$(terraform | awk '/^  [a-z-]/ {print $1}')"
  COMPREPLY=($(compgen -W "${subcommands}" -- "$cur"))
}

complete -F _terraform terraform
